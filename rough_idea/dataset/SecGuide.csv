ID,Preconditions,Secure Coding Guidelines,CWE-IDs,content
M1,The code unit must read serialized data,The code unit should validate the serialized data before deserializing them,502,The product deserializes untrusted data without sufficiently verifying that the resulting data will be valid.
M2,The code unit must store serialized data,The code unit should use cryptography signatures after serializing data,502,deserialized data or code can often be modified without using the provided accessor functions if it does not use cryptography to protect itself. Furthermore; any cryptography would still be client-side security -- which is a dangerous security assumption.
M3,The code unit must read serialized data,The code unit should validate the integrity of serialized data before deserializing them,502,deserialized data or code can often be modified without using the provided accessor functions if it does not use cryptography to protect itself. Furthermore; any cryptography would still be client-side security -- which is a dangerous security assumption.
M4,The code unit must read serialized data,The code unit should have restrictions on gadget chains before deserializing data,502,"When developers place no restrictions on ""gadget chains;"" or series of instances and method invocations that can self-execute during the deserialization process (i.e.; before the object is returned to the caller); it is sometimes possible for attackers to leverage them to perform unauthorized actions; like generating a shell."
M5,The code unit must read serialized data,The code unit should populates a new instance when deserializing an object,502,When deserializing data; populate a new object rather than just deserializing. The result is that the data flows through safe input validation and that the functions are safe.
M6,The code unit must subclass a serializable class that prevents subclasses to be deserialized,The code unit should explicitly define a final object() to prevent deserialization,502,Explicitly define a final object() to prevent deserialization.
M7,The code unit must be deserializable and has fields that should not be deserialized,The code unit should not deserialize protected fields,502,Make fields transient to protect them from deserialization. An attempt to serialize and then deserialize a class containing transient fields will result in NULLs where the transient data should be. This is an excellent way to prevent time; environment-based; or sensitive variables from being carried over and used improperly.
M8,The code unit is not meant to be deserialized,The code unit should cannot be deserialized,502,Avoid having unnecessary types or gadgets available that can be leveraged for malicious ends. This limits the potential for unintended or unauthorized types and gadgets to be leveraged by the attacker.
M9,The code unit must read serialized data,The code unit should deserialize only acceptable classes,502,Add only acceptable classes to an allowlist. Note: new gadgets are constantly being discovered; so this alone is not a sufficient mitigation.
M10,The code unit must read serialized data,The code unit should verify whether the serialized data have been replaced,502,An attacker may be able to replace the intended file with a file that contains arbitrary malicious code which will be executed when the button is pressed.
M11,The code unit must transmit authentication credentials,The code unit should prevent unauthorized access to transmitted credentials,522,The product transmits or stores authentication credentials; but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval.
M12,The code unit must store authentication credentials,The code unit should prevent unauthorized access to stored credentials,522,The product transmits or stores authentication credentials; but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval.
M13,The code unit must involve authentication credentials,The code unit should use a security mechanism to protect credentials,522,Use an appropriate security mechanism to protect the credentials.
M14,The code unit must involve authentication credentials,The code unit should protects credentials through industry standards (e.g. LDAP; keystore; etc.),522,Use industry standards to protect the credentials (e.g. LDAP; keystore; etc.).
M15,The code unit must involve protected objects,The code unit should ensures the requesting user is authorized to access a protected object,522,While the code confirms that the requesting user typed the same new password twice; it does not confirm that the user requesting the password change is the same user whose password will be changed.
M16,The code unit must involve a configuration file with sensitive data,The code unit should protects the accesses to configuration files ,522,anyone who has access to config.properties can read the value of password. If a devious employee has access to this information; they can use it to break into the system.
M17,The code unit must involve a registry key with sensitive data,The code unit should protects the accesses to registry keys ,522,anyone who has access to the registry key used to store the password can read the value of password. If a devious employee has access to this information; they can use it to break into the system
M18,The code unit must store passwords,The code unit should not store passwords with compression,522,Because a compression algorithm is used instead of a one way hashing algorithm; an attacker can recover compressed passwords stored in the database.
M19,The configuration file must contains sensitive data,The code unit should not store username and passwords in configurations files in cleartext,522,Username and password information should not be included in a configuration file or a properties file in cleartext as this will allow anyone who can read the file access to the resource.
M20,The code unit must dereference a pointer,The code unit should ensures a pointer is not NULL before dereferencing it,476,The product dereferences a pointer that it expects to be valid but is NULL.
M21,The code unit must receive data from an external source,The code unit should validate external data before assigning to variables or storing them,476,Identify all variables and data stores that receive information from external sources; and apply input validation to make sure that they are only initialized to expected values.
M22,N/A,The code unit should explicitly initializes all variables and data stores before first usage,476,Explicitly initialize all variables and other data stores; either during declaration or just before the first usage.
M23,The application must use dereference a pointer with multiple threads,The code unit should use proper locking APIs when using pointers,476,When working with a multithreaded or otherwise asynchronous environment; ensure that proper locking APIs are used to lock before the if statement; and unlock when it has finished.
M24,The code unit must accept the upload or transfer of a file,The code unit should assign unique names to uploaded files,434,Generate a new; unique filename for an uploaded file instead of using the user-supplied filename; so that no external input is used at all.
M25,The code unit must accept the upload or transfer of a file and the set of accetable files is known,The code unit should reject uploaded files not belonging to the known set of files,434,When the set of acceptable objects; such as filenames or URLs; is limited or known; create a mapping from a set of fixed input values (such as numeric IDs) to the actual filenames or URLs; and reject all other inputs.
M26,The code unit must accept URLs and the set of accetable URLs is known,The code unit should reject given URLs not belonging to the known set of URLs,434,When the set of acceptable objects; such as filenames or URLs; is limited or known; create a mapping from a set of fixed input values (such as numeric IDs) to the actual filenames or URLs; and reject all other inputs.
M27,The code unit must accept the upload or transfer of a file and store it in the local file system,The code unit should store the uploaded files outside of the web document root,434,Consider storing the uploaded files outside of the web document root entirely. Then; use other mechanisms to deliver the files dynamically .
M28,The code unit must accept the upload or transfer of a file,The code unit should accept only uploaded files whose content conforms to specifications,434,"Assume all input is malicious. Use an ""accept known good"" input validation strategy; i.e.; use a list of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications; or transform it into something that does."
M29,The code unit must accept the upload or transfer of a file,The code unit should not use exclusively denylists to validate uploaded files,434,Do not rely exclusively on looking for malicious or malformed inputs. This is likely to miss at least one undesirable input; especially if the code's environment changes. This can give attackers enough room to bypass the intended validation. However; denylists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.
M30,The code unit must accept the upload or transfer of a file,The code unit should reject uploaded files with unintended extensions,434,For example; limiting filenames to alphanumeric characters can help to restrict the introduction of unintended file extensions.
M31,The code unit must accept the upload or transfer of a file,The code unit should accept uploaded files only with intended extensions,434,Define a very limited set of allowable extensions and only generate filenames that end in these extensions. Consider the possibility of XSS ( CWE-79) before allowing .html or .htm file types.
M32,The code unit must accept the upload or transfer of a file,The code unit should ensures the uploaded file has only one extension,434,"Ensure that only one extension is used in the filename. Some web servers; including some versions of Apache; may process files based on inner extensions so that ""filename.php.gif"" is fed to the PHP interpreter."
M33,The code unit must accept the upload or transfer of a file and the web server supports case-insensitive filenames,The code unit should perform case-insensitive evaluations of the extension of uploaded files,434,When running on a web server that supports case-insensitive filenames; perform case-insensitive evaluations of the extensions that are provided.
M34,The code unit must accept the upload or transfer of a file,The code unit should validate both the content and metadata of uploaded files,434,Do not rely exclusively on sanity checks of file contents to ensure that the file is of the expected type and size. It may be possible for an attacker to hide code in some file segments that will still be executed by the server. For example; GIF images may contain a free-form comments field.
M35,The code unit must accept the upload or transfer of a file and execute it,The code unit should execute the uploaded file with the lowest necessary privileges,434,Run your code using the lowest privileges that are required to accomplish the necessary tasks
M36,The code unit must accept the upload or transfer of a file and execute it,The code unit should create isolated account with limited privileges when executing uploaded files,434,If possible; create isolated accounts with limited privileges that are only used for a single task. That way; a successful attack will not immediately give the attacker access to the rest of the software or its environment. For example; database applications rarely need to run as the database administrator; especially in day-to-day operations.
M37,The code unit must accept the upload or transfer of a file and execute it,The code unit should execute uploaded files in a sandbox enviroment (e.g.; chroot jail),434,"Run the code in a ""jail"" or similar sandbox environment that enforces strict boundaries between the process and the operating system. This may effectively restrict which files can be accessed in a particular directory or which commands can be executed by the software."
M38,The code unit must accept the upload or transfer of a file,The code unit should not allow executing previously uploaded executable files with arbitrary input,434,"The problem with the above code is that there is no check regarding type of file being uploaded. Assuming that pictures/ is available in the web document root; an attacker could upload a file with the name: (attack code) malicious.php Since this filename ends in "".php"" it can be executed by the web server. In the contents of this uploaded file; the attacker could use: (attack code) Example Language: PHP <?php system($_GET['cmd']); ?> Once this file has been installed; the attacker can enter arbitrary commands to execute using a URL such as: (attack code) http://server.example.com/upload_dir/malicious.php?cmd=ls%20-l which runs the ""ls -l"" command - or any other type of command that the attacker wants to specify."
M39,The code unit must accept the upload or transfer of a file and execute it,The code unit should verify the type of files uploaded before executing them,434,This code does not perform a check on the type of the file being uploaded ( CWE-434). This could allow an attack er to upload any executable file or other file with malicious code.
M40,The code unit must accept the upload or transfer of a file and store it in the local file system,The code unit should disallow path elements in uploaded file names,434,"Additionally; the creation of the BufferedWriter object is subject to relative path trav ersal (CWE-23 ). Since the code does not check the filename that is provided in the header; an attacker can use ""../"" sequences to write to files outside of the intended directory. Depending on the executing environment; the attacker may be able to specify arbitrary files to write to; leading to a wide variety of consequences; from code execution; XSS ( CWE-79 ); or system crash."
M41,The code unit must use dynamically allocated memory,The code unit should not reuse a memory area that has been freed,416,The product reuses or references memory after it has been freed.
M42,The code unit must use dynamically allocated memory,The code unit should not call a function via a pointer whose memory has been freed,416,If malicious data is entered before chunk consolidation can take place; it may be possible to take advantage of a write-what-Confidentiality where primitive to execute arbitrary code. If the newly allocated data happens to hold a class; in C++ for example; various Availability function pointers may be scattered within the heap data. If one of these function pointers is overwritten with an address to valid shellcode; execution of arbitrary code can be achieved.
M43,The code unit must use dynamically allocated memory,The code unit should set a pointer to NULL once its memory has been freed,416,When freeing pointers; be sure to set them to NULL once they are freed. However; the utilization of multiple or complex data structures may lower the usefulness of this strategy.
M44,The code unit must allocate resources,The code unit should limit the number of allocated resources,400,If an attacker can trigger the allocation of these limited resources; but the number or size of the resources is not controlled; then the attacker could cause a denial of service that consumes all available resources.
M45,The code unit must allocate resources,The code unit should limit the size of allocated resources,400,If an attacker can trigger the allocation of these limited resources; but the number or size of the resources is not controlled; then the attacker could cause a denial of service that consumes all available resources.
M46,The code unit must allocate resources,The code unit should relsease a resource after its use,400,Not closing/returning a resource after processing
M47,The code unit must allocate resources,The code unit should releases resources on error conditions or other exceptional circumstances,400,Resource exhaustion problems are often result due to an incorrect implementation of the following situations: Error conditions and other exceptional circumstances. Confusion over which part of the program is responsible for releasing the resource.
M48,The code unit must allocate resources,The code unit should is able to release the resources for which it is responsible,400,Resource exhaustion problems are often result due to an incorrect implementation of the following situations: Error conditions and other exceptional circumstances. Confusion over which part of the program is responsible for releasing the resource.
M49,The code unit must allocate resources,The code unit should allow resource allocation only to authorized parties,400,A strong authentication and access control model will help prevent such attacks from occurring in the first place.
M50,The code unit must read data from a database,The code unit should cache the result set from a database access,400,Limiting the database access; perhaps by caching result sets; can help minimize the resources expended.
M51,The code unit must allow users to make some kind of requests,The code unit should prevent users making further requests if their limit has been exceeded,400,consider tracking the rate of requests received from users and blocking requests that exceed a defined rate threshold.
M52,The code unit must allocate resources,The code unit should place the system into a safe posture in case of failures in resource allocation,400,Ensure that all failures in resource allocation place the system into a safe posture.
M53,The code unit must allocate threads,The code unit should limit the numbers of threads that can be created,400,There are no limits to runnables. Potentially an attacker could cause resource problems very quickly.
M54,The code unit must allocate connections,The code unit should limit the numbers of connections that can be made,400,The program does not track how many connections have been made; and it does not limit the number of connections.
M55,The code unit must dump data into a file,The code unit should prevent files from growing without any limit,400,This example creates a situation where data can be dumped to a file on the local file system without any limits on the size of the file. This could potentially exhaust file or disk resources and/or limit other clients' ability to access the service.
M56,The code unit must place external data into strings or character arrays,The code unit should limit the length of strings or character arrays,400,This example creates a situation where the length of the body character array can be very large and will consume excessive memory; exhausting system resources. This can be avoided by restricting the length of the second character array with a maximum length check
M57,The code unit must place external data into buffers,The code unit should limit the length of buffers,400,This example creates a situation where the length of the body supplied can be very large and will consume excessive memory; exhausting system resources. This can be avoided by ensuring the body does not exceed a predetermined length of bytes.
M58,N/A,The code unit should require the right authentication level,306,Divide the software into anonymous; normal; privileged; and administrative areas. Identify which of these areas require a proven user identity; and use a centralized authentication capability.
M59,The code unit must involve some communication channels,The code unit should not open a protected channel without requiring authentication,306,Developers sometimes perform authentication at the primary channel; but open up a secondary channel that is assumed to be private. For example; a login mechanism may be listening on one network port; but after successful authentication; it may open up a second port where it waits for the connection; but avoids authentication because it assumes that only the authenticated party will connect to the port.
M60,The code unit must involve multiple connections/channels within a single session,The code unit should perform authentication at every connection,306,In general; if the software or protocol allows a single session or user state to persist across multiple connections or channels; authentication and appropriate credential management need to be used throughout.
M61,The code unit must be server-side in a client-server application,The code unit should perform the same security checks made on the client side,306,For any security checks that are performed on the client side; ensure that these checks are duplicated on the server side; in order to av oid CWE-602 .
M62,The code unit must be client-side in a client-server application,The code unit should not allow values to be modified after the security checks have been performed,306,Attackers can bypass the client-side checks by modifying values after the checks have been performed; or by changing the client to remove the client-side checks entirely. Then; these modified values would be submitted to the server.
M63,The code unit must be client-side in a client-server application,The code unit should cannot have its intended security checks removed,306,Attackers can bypass the client-side checks by modifying values after the checks have been performed; or by changing the client to remove the client-side checks entirely. Then; these modified values would be submitted to the server.
M64,The application must be web-based and have pages,The code unit should apply authentication before returning the requested page,306,In environments such as the World Wide Web; the line between authentication and authorization is sometimes blurred. If custom authentication routines are required instead of those provided by the server; then these routines must be applied to every single page; since these pages could be requested directly.
M65,The code unit must access data stored in the cloud,The code unit should require authentication when accessing cloud data,306,When migrating data to the cloud (e.g.; S3 buckets; Azure blobs; Google Cloud Storage; etc.); there is a risk of losing the Operation protections that were originally provided by hosting on internal networks. If access does not require authentication; it can be easier for attackers to access the data from anywhere on the Internet.
M66,The code unit's operation must involve protected objects,The code unit should require authentication when requesting operations,306,However; there is no authentication mechanism to ensure that the user creating this bank account object has the authority to create new bank accounts. Some authentication mechanisms should be used to verify that the user has the authority to create bank account objects.
M67,The code unit must involve S3 buckets,The code unit should configure sensitive buckets for no public read access when created,306,The sensitive information could have been protected by ensuring that the buckets did not have public read access; e.g.; by enabling the s3-account-level-public-access-blocks-periodic rule to Block Public Access.
M68,The code unit must involve S3 buckets,The code unit should configure sensitive buckets for encrypted data when created,306,In addition; the data could have been encrypted at rest using the appropriate S3 settings; e.g.; by enabling server-side encryption using the s3-bucket-server-side-encryption-enabled setting. Other settings are available to further prevent bucket data from being leaked.
M69,1. The code unit is web server that handles URL requests,The code unit should properly validates the destination of the request before sending it.,918,The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL; but it does not sufficiently ensure that the request is being sent to the expected destination
M70,1. The code unit handles resources and actions that need to be protected.,The code unit should perform an authorization check when an actor attempts to access a resource or perform an action,863; 862,The product does not perform an authorization check when an actor attempts to access a resource or perform an action.
M71,1. The code unit handles resources and actions that need to be protected.,The code unit should include or references a mapping of roles with accessible data and functionality,863; 862,Reduce the attack surface by carefully mapping roles with data and functionality.
M72,"1. The code unit handles resources and actions that need to be protected.
2. The code unit handles access control
3. The code unit has defined boundaries",The code unit should use role-based access control (RBAC) to enforce the roles at the appropriate boundaries,863; 862,Use role-based access control (RBAC) [ REF-229] to enforce the roles at the appropriate boundaries.
M73,"1. The code unit handles resources and actions that need to be protected.
2. The code unit handles access control
3. Business logic is available",The code unit should perform access controls related to the business logic,863; 862,Ensure that access control checks are performed related to the business logic.
M74,1. The code unit handles resources and actions that need to be protected.,The code unit should use a vetted library or framework that prevents missing authorization weakness such as JAAS authorization and OWASP ESAPI Access Control feature,863; 862,Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid. For example; consider using authorization frameworks such as the JAAS Authorization Framework [REF-233 ] and the OWASP ESAPI Access Control feature [ REF-45].
M75,"1. The code unit handles resources and actions that need to be protected.
2. The code unit is a web application with server side",The code unit should enforce access control mechanism at the server side ,863; 862,For web applications; make sure that the access control mechanism is enforced correctly at the server side on every page.
M76,"1. The code unit handles resources and actions that need to be protected.
2. The code unit is a web application",The code unit should provide access to functionalities or information to unauthorized users requesting direct access to the page,863; 862,Users should not be able to access any unauthorized functionality or information by simply requesting direct access to that page.
M77,"1. The code unit handles resources and actions that need to be protected.
2. The code unit is a web application containing sensitive information",The code unit should cache pages containing sensitive information,863; 862,One way to do this is to ensure that all pages containing sensitive information are not cached;
M78,"1. The code unit handles resources and actions that need to be protected.
2. The code unit is a web application containing sensitive information",The code unit should restrict the access to pages containing sensitive information to authorized users with active and authenticates session token.,863; 862,that all such pages restrict access to requests that are accompanied by an active and authenticated session token associated with a user who has the required permissions to access that page.
M79,1. The code unit handles sensitive information,The code unit should store sensitive information (passwords; keys; credentials etc.) in a strongly protected encrypted configuration file or database with restricted access,798,For outbound authentication: store passwords; keys; and other credentials outside of the code in a strongly-protected; encrypted configuration file or database that is protected from access by all outsiders; including other local users on the same system.
M80,The code unit handles keys,The code unit should properly protect the key,798,Properly protect the k ey (CWE-320 ). 
M81,1. The code unit handles files with sensitive information,The code unit should restrict the permissions to files that cannot encrypted,798,If you cannot use encryption to protect the file; then make sure that the permissions are as restrictive as possible
M82,1. The code unit handles user logins,"The code unit should utilize a ""first login"" mode that requires the user to enter a unique strong password or key rather than hardcode default credentials for first time logins",798,"For inbound authentication: Rather than hardcode a default username and password; key; or other authentication credentials for first time logins; utilize a ""first login"" mode that requires the user to enter a unique strong password or key."
M83,1. The code unit includes features controlled by hard-coded credentials,The code unit should perform access control checks and limit which entities can access the feature that requires the hardcoded credentials,798,If the product must contain hardcoded credentials or they cannot be removed; perform access control checks and limit which entities can access the feature that requires the hardcoded credentials
M84,1. The code unit handles sensitive information,The code unit should apply strong one-way hashes to the passwords,798,For inbound authentication using passwords: apply strong one-way hashes to passwords 
M85,1. The code unit handles sensitive information,The code unit should store the password hashes in a configuration file or database with appropriate access control,798,and store those hashes in a configuration file or database with appropriate access control. That way; theft of the file/database still requires the attacker to try to crack the password
M86,1. The code unit handles authentication,The code unit should compare the hash of an incoming password to a saved hash during authentication,798,When handling an incoming password during authentication; take the hash of the password and compare it to the saved hash.
M87,1. The code unit generates hashes,The code unit should randomly assigns salts for each separate hash that is generated,798,Use randomly assigned salts for each separate hash that is generated.
M88,1. The code unit generates passwords or keys,The code unit should use generated passwords or keys that are automatically updated and require input by a system administrator at specified time intervals.,798,For front-end to back-end connections: Three solutions are possible; although none are complete. The first suggestion involves the use of generated passwords or keys that are changed automatically and must be entered at given time intervals by a system administrator. 
M89,1. The code unit handles temporary passwords,The code unit should keep temporary passwords in the memory for the specific time interval; beyond which the passwords becomes invalid,798,These passwords will be held in memory and only be valid for the time intervals. 
M90,"1. The code unit works with backend and front end
2. The code unit handles passwords or keys",The code unit should limit the backend passwords or keys to only perform actions valid for the front end instead of having full access,798,For front-end to back-end connections: Next; the passwords or keys should be limited at the back end to only performing actions valid for the front end; as opposed to having full access. 
M91,1. The code unit handles messages sent using time sensitive values,The code unit should tag and checksum the messages sent using time sensitive values to prevent replay-style attacks,798,For front-end to back-end connections: Finally; the messages sent should be tagged and checksummed with time sensitive values so as to prevent replay-style attacks.
M92,1. The code unit handles sentsitive information,The code unit should encrypt the username and passwords information,798,If possible; encrypt this information (username and password information).
M93,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should wrap critical code using synchronization primitives,362,In languages that support it; use synchronization primitives. Only wrap these around critical code to minimize the impact on performance.
M94,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should use thread-safe capabilities,362,Use thread-safe capabilities such as the data access abstraction in Spring.
M95,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should use thread-safe functions when using multithreading or performing operations on shared variables.,362,When using multithreading and operating on shared variables; only use thread-safe functions.
M96,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should perform non-atomic operations on shared variables,362,"Use atomic operations on shared variables. Be wary of innocent-looking constructs such as ""x++""."
M97,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should use mutex for shared variables or resources,362,Use a mutex if available; but be sure to avoid related weaknesses such as CWE-412.
M98,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should avoid double-checked locking,362,Avoid double-checked locking ( CWE-609 ) and other implementation errors that arise when trying to avoid the overhead of synchronization.
M99,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should disables interrupts or signals over critical parts of the code ,362,Disable interrupts or signals over critical parts of the code; but also make sure that the code does not go into a large or infinite loop.
M100,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should use volatile type modifier for critical variables,362,Use the volatile type modifier for critical variables to avoid unexpected compiler optimization or reordering.
M101,"1. The code unit handles concurrent; parallel or multithreaded programming that involves resource sharing
2. The programming language supports synchronisation primitives",The code unit should use lowest privileges that are necessary for performing tasks involving resource sharing,362,Run your code using the lowest privileges that are required to accomplish the necessary tasks
M102,1. The code unit handles HTTP requests from external actors,The code unit should sufficiently verify whether a request was intentionally provided by the user who submitted the request.,352,The web application does not; or can not; sufficiently verify whether a well-formed; valid; consistent request was intentionally provided by the user who submitted the request.
M103,1. The code unit handles HTTP requests from external actors,The code unit should use vetted library or framework that does not allow CSRF ,352,Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid. 
M104,1. The code unit handles HTTP requests from external actors,The code unit should prevent XSS attacks,352,Ensure that the application is free of cross-site scripting issues ( CWE-79 ); because most CSRF defenses can be bypassed using attacker-controlled script.
M105,1. The code unit handles HTTP requests from external actors,The code unit should use a unique and unpredictable nonce to verify a submitted form,352,Generate a unique nonce for each form; place the nonce into the form; and verify the nonce upon receipt of the form. Be sure that the nonce is not predictable
M106,"1. The code unit handles HTTP requests from external actors
2. The HTTP request performs a dangerous action",The code unit should sends a separate confirmation request to ensure that the user intended to perform an operation that is deemed dangerous,352,Identify especially dangerous operations. When the user performs a dangerous operation; send a separate confirmation request to ensure that the user intended to perform that operation.
M107,1. The code unit handles HTTP requests from external actors,The code unit should perform double-submitted cookie method,352,"Use the ""double-submitted cookie"" method"
M108,1. The code unit handles HTTP POST requests from external actors,The code unit should generate a pseudorandom value and set it as a cookie on the user's machine. ,352,When a user visits a site; the site should generate a pseudorandom value and set it as a cookie on the user's machine. 
M109,1. The code unit handles HTTP POST requests from external actors,The code unit should verify if the pseudorandom value is present as a form value and a cookie value,352,The site should require every form submission to include this value as a form value and also as a cookie value. 
M110,1. The code unit handles HTTP requests from external actors,The code unit should generate cryptographically strong pseudorandom value as cookie,352,To successfully submit a form on behalf of the user; the attacker would have to correctly guess the pseudorandom value. If the pseudorandom value is cryptographically strong; this will be prohibitively difficult.
M111,1. The code unit handles HTTP requests from external actors,The code unit should use GET method for any request that triggers a state change,352,Do not use the GET method for any request that triggers a state change.
M112,1. The code unit handles HTTP requests from external actors,The code unit should verify the origin page of the request by checking the HTTP Referer header,352,Check the HTTP Referer header to see if the request originated from an expected page.
M113,1. The code unit handles actions performed by an actor,The code unit should verify the identity of an actor,287,When an actor claims to have a given identity; the product does not prove or insufficiently proves that the claim is correct
M114,1. The code unit set resource permissions,The code unit should assign persmissions that allow anyone to modify the files,276,During installation; installed file permissions are set to allow anyone to modify those files.
M115,1. The code unit set resource permissions,The code unit should restrict access and modification rights to only those users who require those actions,276,The architecture needs to access and modification attributes for files to only those users who actually require those actions.
M116,"1. The code unit handles sensitive data
2. The code unit has a trust boundary",The code unit should allow sensitive data to go outside of the trust boundary.,276,Do not allow sensitive data to go outside of the trust boundary
M117,1. The code unit handles user privilege assignment,The code unit should follow the principle of least privilege when assigning access rights to entities in a software system.,276; 269,Architects and designers should rely on the principle of least privilege to decide the appropriate time to use privileges and the time to drop privileges.
M118,1. The code unit handles user privilege assignment,The code unit should properly assign or modifie the privileges of an actor.,269,The product does not properly assign or modify privileges for an actor; creating an unintended sphere of control for that actor
M119,1. The code unit handles handles actions that require user privileges,The code unit should properly track or check privileges for an actor,269,The product does not properly track; or check privileges for an actor; creating an unintended sphere of control for that actor
M120,1. The code unit handles user privileges,The code unit should carefully set; manage and handle the privileges,269,Very carefully manage the setting; management; and handling of privileges. 
M121,1. The code unit has trust zones,The code unit should explicitly manage trust zones in the software,269,Explicitly manage trust zones in the software.
M122,1. The code unit handles resource privilege assignment,The code unit should follows the principle of separation of privileges.,269,Consider following the principle of separation of privilege. Require multiple conditions to be met before permitting access to a system resource.
M123,1. The code unit sends the sensitive information into another source,The code unit should explicitly inserts sensitive information into resources or messages accessible to unauthorized actors,200,"the code explicitly inserts sensitive information into resources or messages that are intentionally made accessible to unauthorized actors; but should not contain the information - i.e.; the information should have been ""scrubbed"" or ""sanitized"""
M124,1. The code unit sends the sensitive information into another source,The code unit should not let another weakness or code error indirectly insert sensitive information into resources or messages accessible to unauthorized actors,200,different weakness or mistake indirectly inserts the sensitive information into resources; such as a web script error revealing the full system path of the program.
M125,1. The code unit handles sensitive resources,The code unit should make sensitive resources accessible to unauthorized users,200,the code manages resources that intentionally contain sensitive information; but the resources are unintentionally made accessible to unauthorized actors.
M126,1. The code unit handles sensitive resources,The code unit should is compartmentalized to have safe areas with trust boundaries,200,"Compartmentalize the system to have ""safe"" areas where trust boundaries can be unambiguously drawn"
M127,1. The code unit handles sensitive resources,The code unit should prevent sensitive data to go out side of the trust boundary,200,Do not allow sensitive data to go outside of the trust boundary
M128,1. The code unit handles sensitive resources,The code unit should implement the principle of least privilege on sensitive resources,200,Architects and designers should rely on the principle of least privilege to decide the appropriate time to use privileges and the time to drop privileges
M129,1. The code unit handles integer operations,The code unit should define strict protocols to identify out-of-bounds behavior,190,Ensure that all protocols are strictly defined; such that all out-of-bounds behavior can be identified simply; and require strict conformance to the protocol.
M130,1. The code unit handles integer operations,The code unit should use vetted library or framework that prevents out-ouf-bounds weakness,190,Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid
M131,1. The code unit accepts numeric inputs from external components such as users; modules etc.,The code unit should perform input validation on all numberic inputs to ensure that they are within the expected range,190,Perform input validation on any numeric input by ensuring that it is within the expected range.
M132,1. The code unit handles integer operations,The code unit should use unsigned integers where possible,190,Use unsigned integers where possible.
M133,1. The code unit handles signed integer operations,The code unit should verify if the signed integers meets both minimum and maximum requirements for the expected range,190,When signed integers are required; ensure that the range check includes minimum values as well as maximum values.
M134,1. The code unit handles client side and server side,The code unit should duplicate the client side security checks on the server side.,190; 22,For any security checks that are performed on the client side; ensure that these checks are duplicated on the server side;
M135,1. The code unit handles client side and server side,The code unit should prevent the submission of modified filepaths to the server after manually disabling or bypassing client-side validation checks,190; 22,Attackers can bypass the client-side checks by modifying values after the checks have been performed; or by changing the client to remove the client-side checks entirely. Then; these modified values would be submitted to the server.
M136,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should use an accept list to verify acceptable inputs,125; 89; 78; 77; 22; 20,"Use an ""accept known good"" input validation strategy; i.e.; use a list of acceptable inputs that strictly conform to specifications."
M137,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should verify the expected specifications of every input,125; 78; 77; 22; 20,Reject any input that does not strictly conform to specifications; or transform it into something that does.
M138,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should validate the input length,125; 89; 79; 78; 77; 22; 20,When performing input validation; consider all potentially relevant properties; including length; 
M139,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should validate the input type,125; 89; 79; 78; 77; 22; 20,type of input;
M140,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should validate the input to be in the range of acceptable values,125; 89; 78; 77; 22; 20,the full range of acceptable values
M141,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should verify if there are any misssing or extra inputs,125; 89; 79; 78; 77; 22; 20,; missing or extra inputs
M142,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit accepts inputs that require syntax or format validation",The code unit should validate the syntax of the input,125; 89; 79; 78; 77; 22; 21,; syntax; 
M143,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit contains related input fields",The code unit should validate the consistency of data entered across related input fields.,125; 89; 78; 77; 22; 20,consistency across related fields;
M144,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. There are business rules that the input should statisfy",The code unit should validate the input conformance to business rules ,125; 20; 77; 79; 78; 22,and conformance to business rules
M145,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should contain a denylist for the inputs,125; 89; 78; 77; 22; 20,denylists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.
M146,The code unit performs arithmetic calculations based on buffers,The code unit should validate correct calculations for any length argument; buffer size calculation or offset,125,ensure that you validate and ensure correct calculations for any length argument; buffer size calculation; or offset.
M147,"1. The code unit is written in language suceptible to buffer related weaknesses
2. The code unit handles buffer operations",The code unit should use vetted library or framework that prevents impropeor operations within the bounds of a memory buffer,119,Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.
M148,"1. The code unit is written in language suceptible to buffer related weaknesses
2. The code unit handles buffer operations",The code unit should verify if the buffer is as large as specified,119,Consider adhering to the following rules when allocating and managing an application's memory: Double check that the buffer is as large as specified.
M149,"1. The code unit is written in language suceptible to buffer related weaknesses
2. The code unit handles buffer operations",The code unit should verify if the destination buffer size is equal to the source buffer size when copying content.,119,When using functions that accept a number of bytes to copy; such as strncpy(); be aware that if the destination buffer size is equal to the source buffer size; it may not NULL-terminate the string.
M150,"1. The code unit is written in language suceptible to buffer related weaknesses
2. The code unit handles buffer operations",The code unit should verfies the buffer boundaries when accessing buffer in a loop.,119,Check buffer boundaries if accessing the buffer in a loop and make sure there is no danger of writing past the allocated space.
M151,"1. The code unit is written in language suceptible to buffer related weaknesses
2. The code unit handles buffer operations",The code unit should truncates all input strings to a reasonable length before passing them to copy and concatenation function,119,If necessary; truncate all input strings to a reasonable length before passing them to the copy and concatenation functions.
M152,"1. The code unit is written in language suceptible to buffer related weaknesses
2. The code unit handles buffer operations",The code unit should use unbounded copy functions that do not support length arguments,119,Replace unbounded copy functions with analogous functions that support length arguments; such as strcpy with strncpy.
M153,1. The code unit constructs code segments using external inputs,The code unit should use external inputs from a upstream component to construct parts of a code segment without properly neutralizing the special elements in it. ,94,The product constructs all or part of a code segment using externally-influenced input from an upstream component; but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.
M154,1. The code unit constructs code segments and executes it,The code unit should execute code segments in a sandbox environment,94,"Run your code in a ""jail"" or similar sandbox environment that enforces strict boundaries between the process and the operating system. This may effectively restrict which code can be executed by your product."
M155,1. The code unit constructs code segments using external inputs,The code unit should use stringent allowlists that limit which constructs are allowed,94,To reduce the likelihood of code injection; use stringent allowlists that limit which constructs are allowed.
M156,"1. The code unit constructs code segments using external inputs
2. The code unit is in Python
3. The code unit uses eval function",The code unit should use ast.literal_eval() function instead of eval,94,For Python programs; it is frequently encouraged to use the ast.literal_eval() function instead of eval; since it is intentionally designed to avoid executing code. However; an adversary could still cause excessiv e memory or stack consumption via deeply nested structures [REF-1372]; so the python documentation discourages use of ast.literal_eval() on untrusted data
M157,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)",The code unit shoulds quotes all input fields,89,attackers can: Target fields that are not quoted 
M158,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)",The code unit should escape all meta-characters properly,89,Find ways to bypass the need for certain escaped meta-characters 
M159,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
3. The code unit implements stored procedure","The code unit should implements stored procedure correctly:
- the stored procedure should avoid dynamic SQL queries
- the stored procedure should use parameterized queries",89,Use stored procedures to hide the injected meta-characters. Manually escaping characters in input to SQL queries can help; but it will not make your application secure from SQL injection attacks.
M160,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)",The code unit should separates user provided data and executable commands in code,89,If available; use structured mechanisms that automatically enforce the separation between data and code. These mechanisms may be able to provide the relevant quoting; encoding; and validation automatically; instead of relying on the developer to provide this capability at every point where output is generated.
M161,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)",The code unit should use prepared statements; parameterized queries or stored procedures for processing SQL queries,89,Process SQL queries using prepared statements; parameterized queries; or stored procedures
M162,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)","The code unit should dynamically construct and execute query strings using ""exec"" or similar functionality.",89,"Do not dynamically construct and execute query strings within these features using ""exec"" or similar functionality; since this may re-introduce the possibility of SQL injection"
M163,"1.  The code unit handles SQL database operations
2. The code unit creates user accounts to a SQL database",The code unit should follow the principle of least privilege when creating user accounts to a SQL database,89,follow the principle of least privilege when creating user accounts to a SQL database.
M164,"1. The code unit handles SQL database operations
2. The code unit handles user accounts with read/write privilege",The code unit should limit the user privileges such that the users with read/write privileges cannot read/write others' data,89,If the requirements of the system indicate that a user can read and modify their own data; then limit their privileges so they cannot read/write others' data. 
M165,"1. The code unit handles SQL database operations
",The code unit should use the strictest permissions possible on all database objects.,89,Use the strictest permissions possible on all database objects; such as execute-only for stored procedures.
M166,1. The code unit has a client side and server side,The code unit should perform same security checks on both client and server side.,89,For any security checks that are performed on the client side; ensure that these checks are duplicated on the server side;
M167,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should escape or filter all characters that do not pass an extremely strict allowlist.,89,The most conservative approach is to escape or filter all characters that do not pass an extremely strict allowlist (such as everything that is not alphanumeric or white space). 
M168,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)",The code unit should wrap arguments in quotes after the escaping/filtering step when handling special characters,89,If some special characters are still needed; such as white space; wrap each argument in quotes after the escaping/filtering step.
M169,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should accept any input that does not conform to specifications,89,Reject any input that does not strictly conform to specifications; 
M170,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should transform all input that does not conform to specifications into something that does,78; 77; 20; 89,or transform it into something that does.
M171,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should validate the input consistency across related fields ,89,consistency across related fields;
M172,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should use stringent allowlists that limit the character set based on the expected value of the parameter in the request,89,When constructing SQL query strings; use stringent allowlists that limit the character set based on the expected value of the parameter in the request
M173,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)",The code unit should perform proper output encoding,89,Note that proper output encoding;
M174,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)",The code unit should perform output escaping ,89, escaping; 
M175,"1. The code unit contains SQL statements
2. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)",The code unit should perform output quoting,89,and quoting is the most effective solution for preventing SQL injection; although input validation may provide some defense-in-depth.
M176,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. A list of expected or acceptable input values are provided",The code unit should use a mapping from a set of fixed expected input values to the actual inputs when the acceptable inputs are known,89; 79,When the set of acceptable objects; such as filenames or URLs; is limited or known; create a mapping from a set of fixed input values (such as numeric IDs) to the actual filenames or URLs; and reject all other inputs.
M177,1. The code unit prints error messages,The code unit should provide unnecessary details in the error messages,89,Ensure that error messages only contain minimal details that are useful to the intended audience and no one else.
M178,1. The code creates or write to log files,The code unit should save highly sensitive information to the log files,89,Highly sensitive information such as passwords should never be saved to log files.
M179,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should contain a denylist for the inputs,89,or identify and escape a denylist of potentially malicious values.
M180,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. It is feasible to disallow meta-characters",The code unit should disallow meta-characters entirely when feasible,89,When feasible; it may be safest to disallow meta-characters entirely; instead of escaping them. This will provide some defense in depth
M181,1. The code unit handles web requests,The code unit should accept untrusted data as input from a web request,79,Cross-site scripting (XSS) vulnerabilities occur when: 1. Untrusted data enters a web application; typically from a web request. 
M182,1. The code unit generates a web page,The code unit should dynamically generates a web page using untrusted data that contains executable content,79,2. The web application dynamically generates a web page that contains this untrusted data.  3. During page generation; the application does not prevent the data from containing content that is executable by a web browser; such as JavaScript; HTML tags; HTML attributes; mouse events; Flash; ActiveX; etc. 
M183,1. The code unit handles HTTP request and responses,The code unit should read data directly from the HTTP request and reflects it back in the HTTP response,79,The server reads data directly from the HTTP request and reflects it back in the HTTP response.
M184,1. The code unit generates a web page,The code unit should injects server-supplied script containing user-supplied data into a webpage,79,DOM-based XSS generally involves server-controlled; trusted script that is sent to the client; such as Javascript that performs sanity checks on a form before the user submits it. If the server-supplied script processes user-supplied data and then injects it back into the web page (such as with dynamic HTML); then DOM-based XSS is possible
M185,1. The code unit generates a web page,The code unit should apprpriately encodes all non-alphanumeric characters in data that will be output to another webpage.,79,For any data that will be output to another web page; especially any data that was received from external inputs; use the appropriate encoding on all non-alphanumeric characters.
M186,1. The code unit generates output,The code unit should specify the correct output encoding that needs to be used,79,Use and specify an output encoding that can be handled by the downstream component that is reading the output. Common encodings include ISO-8859-1; UTF-7; and UTF-8.
M187,1. The code unit handles HTTP requests,The code unit should specify encoding in the HTTP header,79,If an encoding is not specified in an HTTP header; web browsers often guess about which encoding is being used. This can open up the browser to subtle XSS attacks.
M188,1. The code unit handles HTTP requests,The code unit should set the session cookie to HttpOnly,79,To help mitigate XSS attacks against the user's session cookie; set the session cookie to be HttpOnly
M189,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should use a list of acceptable inputs that strictly conform to specifications,79,"Use an ""accept known good"" input validation strategy; i.e.; use a list of acceptable inputs that strictly conform to specifications. "
M190,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should reject any input that does not strictly conform to specifications or transform it to something that does,79,Reject any input that does not strictly conform to specifications; or transform it into something that does.
M191,1. The code unit handles HTTP requests,The code unit should use stringent allowlist that limit the character set based on the expected value of the request parameter while dynamically constructing webpages,125; 20; 77; 79; 78; 22,When dynamically constructing web pages; use stringent allowlists that limit the character set based on the expected value of the parameter in the request. 
M192,1. The code unit handles HTTP requests,The code unit should validate the data in the request including hidden fields; cookies; headers; the URL itself; and so forth. ,79,but all data in the request; including hidden fields; cookies; headers; the URL itself; and so forth.
M193,1. The code unit generates output,The code unit should perform proper output encoding; escaping; and quoting,79,proper output encoding; escaping; and quoting is the most effective solution for preventing XSS; although input validation may provide some defense-in-depth.
M194,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit has interfaces",Check if hte code unit performs input validation at well-defined intergaces in the application,79,Ensure that you perform input validation at well-defined interfaces within the application. This will help protect the application even if a component is reused or moved elsewhere.
M195,1. The code unit constructs OS commands using external inputs,The code unit should construct an OS command using externally-influenced input from a component whose special elements are not correctly neutralized.,78,The product constructs all or part of an OS command using externally-influenced input from an upstream component; but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.
M196,1. It is possible to use library calls instead of external processes to perform a desired functionality,The code unit should use appropriate library calls to implement the desired functionality instead of relying on external processes.,78,If at all possible; use library calls rather than external processes to recreate the desired functionality.
M197,1. The code unit executes OS commands,The code unit should execute OS commands in a sandbox environtment such as chroot Jail; AppArmor etc.,78,"Run the code in a ""jail"" or similar sandbox environment that enforces strict boundaries between the process and the operating system. This may effectively restrict which files can be accessed in a particular directory or which commands can be executed by the software."
M198,1. The code unit executes OS commands,The code unit should keep the data used to generate an executable command out of external control,78,For any data that will be used to generate a command to be executed; keep as much of that data out of external control as possible.
M199,"1. The code unit is a web application
2. The code unit generates executable commands using some data",The code unit should store data used for command generation is stored locally in the session's state instead of sending it out to the client in a hidden form field.,78,For example; in web applications; this may require storing the data locally in the session's state instead of sending it out to the client in a hidden form field.
M200,1. The code unit executes OS commands,The code unit should use vetted library or framework that prevents OS command injection weakness,78,Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.
M201,1. The code unit executes OS commands,The code unit should properly quotes and escapes the special characters in the arguments used for command construction,78,Properly quote arguments and escape any special characters within those arguments.
M202,1. The code unit constructs OS commands using external inputs,The code unit should keep a strict allowlist for characters present in the arguments used for command construction,78,The most conservative approach is to escape or filter all characters that do not pass an extremely strict allowlist (such as everything that is not alphanumeric or white space). I
M203,1. The code unit constructs OS commands using external inputs,The code unit should escape or filters all the characters that do not pass an extremely strict allowlist of characters,78,The most conservative approach is to escape or filter all characters that do not pass an extremely strict allowlist (such as everything that is not alphanumeric or white space). I
M204,1. It is possible to take input arguments via standard input or an input file,The code unit should take input arguments via command line,78,If the program to be executed allows arguments to be specified within an input file or from standard input; then consider using that mode to pass arguments instead of the command line.
M205,"1. The code unit constructs OS commands using external inputs
2. Structured mechanisms that enable separatio between code and data are available",The code unit should use structures mechanisms that automatically enforce separation between data and code,78,If available; use structured mechanisms that automatically enforce the separation between data and code.
M206,1. The code unit constructs OS commands using external inputs,The code unit should perform proper output encoding; escaping and quoting of the arguments used in OS commands,78,Note that proper output encoding; escaping; and quoting is the most effective solution for preventing OS command injection; although input validation may provide some defense-in-depth.
M207,1. The code unit has a known list of acceptable objects such as filenames or URLs,The code unit should reject objects such as filenames or URLs not belonging to the known set of objects,78,When the set of acceptable objects; such as filenames or URLs; is limited or known; create a mapping from a set of fixed input values (such as numeric IDs) to the actual filenames or URLs; and reject all other inputs.
M208,1. The code unit displays error messages,The code unit should include unnecessary details in the error messages,78,Ensure that error messages only contain minimal details that are useful to the intended audience and no one else.
M209,1. The code unit displays error messages,The code unit should record the detailed error messages as log messages with restricted access,78,If errors must be captured in some detail; record them in log messages; but consider what could occur if the log messages can be viewed by attackers. Highly sensitive information such as passwords should never be saved to log files.
M210,1. The code unit stores sensitive information,The code unit should save highly senstive information such as passwords to log files,78,Highly sensitive information such as passwords should never be saved to log files.
M211,1. The code unit displays messages,The code unit should displays inconsistent messages about sensitive information such as the internal state of the system,78,Avoid inconsistent messaging that might accidentally tip off an attacker about internal state; such as whether a user account exists or not.
M212,1. The code unit handles OS command execution,The code unit should use an allowlist of allowable commands and reject the ones that do not belong to this list,78,Use runtime policy enforcement to create an allowlist of allowable commands; then prevent use of any command that does not appear in the allowlist. Technologies such as AppArmor are available to do this
M213,"1. The code unit is written in PHP
2. ?",The code unit should use register_globals,78,When using PHP; configure the application so that it does not use register_globals.
M214,1. The code unit constructs commands using external inputs,The code unit should construct a command using externally-influenced input from a component whose special elements are not correctly neutralized.,77,The product constructs all or part of a command using externally-influenced input from an upstream component; but it does not neutralize or incorrectly neutralizes special elements that could modify the intended command when it is sent to a downstream component
M215,1. The code unit executes external commands,The code unit should execute external commands that only created statically,77,If possible; ensure that all external commands called from the program are statically created.
M216,1. The code unit accepts filenames or paths as inputs from an external component (e.g.; user; other module etc.),The code unit should contain stringent allowlist that limit the character set to be used for validating filenames,22,When validating filenames; use stringent allowlists that limit the character set to be used.
M217,"1. The code unit accepts filenames or paths as inputs from an external component (e.g.; user; other module etc.)
2. It is feasible to restrict the directory separators such as ""/"" and characters such as "".""","The code unit should restrict the filename to have only a single ""."" character and exclude directory separators such as ""/""; if possible",22,"If feasible; only allow a single ""."" character in the filename to av oid weaknesses such as CWE-23 ; and exclude directory separators such as ""/"" to av oid CWE-36."
M218,1. The code unit accepts filenames or paths as inputs from an external component (e.g.; user; other module etc.),The code unit should use a list of allowable file extensions,22,Use a list of allow able file extensions; which will help to av oid CWE-434 .
M219,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should decode and canonicalizes the input to the application's current internal representation before validating it.,22,Inputs should be decoded and canonicalized to the application's current internal representation before being v alidated
M220,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit accepts inputs that need to be decoded",The code unit should decode the same input twice.,22,Make sure that the application does not decode the same input twice
M221,1. The code unit accepts filenames or paths as inputs from an external component (e.g.; user; other module etc.),"The code unit should use a built-in path canonicalization function to remove "".."" sequences and symbolic links.",22,"Use a built-in path canonicalization function (such as realpath() in C) that produces the canonical version of the pathname; which effectively removes "".."" sequences and symbolic links"
M222,1. The code unit handles tasks with access control.,The code unit should use the lowest privileges to accomplish the necessary tasks,22,Run your code using the lowest privileges that are required to accomplish the necessary tasks
M223,"1. The code unit handles tasks with access control.
",The code unit should create isolated accounts with limited privileges per task.,22,If possible; create isolated accounts with limited privileges that are only used for a single task.
M224,1. The code unit accepts filenames or paths as inputs from an external component (e.g.; user; other module etc.),"The code unit should run in ""jail"" or similar sandbox environment that enforces strict boundaries between the process and the operating system",22,"Run the code in a ""jail"" or similar sandbox environment that enforces strict boundaries between the process and the operating system."
M225,"1. The code handles web-based services
2. The code unit stores library; include or utility files",The code unit should store library; include; and utility files outside of the web document root or in a separate directory and ensure strict access control to the web server,22,Store library; include; and utility files outside of the web document root; if possible. Otherwise; store them in a separate directory and use the web server's access control capabilities to prevent attackers from directly requesting them.
M226,1. The code unit displays error messages,The code unit should restrict the information displayed in the error messages,22,Ensure that error messages only contain minimal details that are useful to the intended audience and no one else. The messages need to strike the balance between being too cryptic (which can confuse users) or being too detailed (which may reveal more than intended). The messages should not reveal the methods that were used to determine the error.
M227,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should not accept unexpected values as inputs.,20,An attacker could provide unexpected values and cause a program crash or excessive consumption of resources; such as memory and CPU.
M228,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The input properties are being used in the code",Check if the properties of input are correctly derived in the code unit,20,Errors in deriving properties may be considered a contributing factor to improper input validation. (Context: properties include properties of raw data and meta data that include size; length; frequency; rate and so on.)
M229,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should filters the input to remove dangerous inputs,20,such as filtering ( CWE-790) - which attempts to remove dangerous inputs
M230,The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should encode and escapes the input,20,or encoding/escaping ( CWE-116 ); which attempts to ensure that the input is not misinterpreted when it is included in output to another component.
M231,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit combines data from multiple sources",The code unit should perform validation after combining data from multiple sources.,20,When your application combines data from multiple sources; perform the validation after the sources have been combined. The individual data elements may pass the validation step but violate the intended restrictions after they have been combined.
M232,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit invokes code from another language",The code unit should validate inputs when invoking code from another language,20,validate all input when invoking code that crosses language boundaries; such as from an interpreted language to native code. Consequence:This could create an unexpected interaction between the language boundaries
M233,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should convert all inputs into the expected data type,20,Directly convert your input type into the expected data type; such as using a conversion function that translates a string into a number. 
M234,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should verifies if the inputs value falls in the expected range of values after conversion.,20,After converting to the expected data type; ensure that the input's values fall within the expected range of allowable values and that multi-field consistencies are maintained
M235,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit accepts inputs that need to be decoded",The code unit should decode the input to the application's current internal representation before validating it.,20,Inputs should be decoded to the application's current internal representation before being v alidated (CWE-180 ; CWE-181 ). 
M236,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should canonicalize the input to the application's current internal representation before validating it.,20,Input should be canonicalized to the application's current internal representation before being v alidated (CWE-180 ; CWE-181 ).
M237,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should perform repeated canonicalization until the input does not change.,20,Consider performing repeated canonicalization until your input does not change any more. Reason: This will avoid double-decoding and similar scenarios; but it might inadvertently modify inputs that are allowed to contain properly-encoded dangerous content
M238,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit exchanges data between different components",The code unit should perform correct and consistent encoding at each interface while exchanging data between components,20,Ensure that the proper encoding is applied at each interface. 
M239,1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.),The code unit should explicitly sets the required encoding whenever possible.,20,Explicitly set the encoding you are using whenever the protocol allows you to do so.
M240,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit converts the inputs into tokens",The code unit should verify if the input tokens are in compliance with the rules of the specified or derived  types,20,- compliance with rules for what is treated as a token specified or derived type 
M241,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. A set of domain specific rules are provided",The code unit should verify if the input conforms to the domain-specific rules,20,conformance to domain-specific rules; e.g. business logic equivalence - ensuring that equivalent inputs are treated the same
M242,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. Authenticity and ownership are relevant to the input",The code unit should verify the authenticity; ownership or other attestations about the input.,20,authenticity; ownership; or other attestations about the input; e.g. a cryptographic signature to prove the source of the data Implied or derived properties of data must often be calculated or inferred by the code itself.
M243,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit uses the metadata of the provided input",The code unit should validate metadata (such as information about the raw data; such as headers or size),20,metadata - information about the raw data; such as headers or size
M244,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
",The code unit should validate the implied and derived quantities of the input data (such as such as the actual size of a file instead of a specified size indexes; offsets; or positions into more complex data structures symbolic keys or other elements into hash tables; associative arrays; etc.),20,implied or derived quantities; such as the actual size of a file instead of a specified size indexes; offsets; or positions into more complex data structures symbolic keys or other elements into hash tables; associative arrays; etc.
M245,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit uses the metadata of the provided input",The code unit should validate the specified properties of the metadata (such as size; length; etc. ),20,Many properties of metadata may need to be validated upon entry into the code; such as: specified quantities such as size; length; frequency; price; rate; number of operations; time; etc. 
M246,"1. The code unit accepts inputs from an external component (e.g.; user; other module; etc.)
2. The code unit uses the metadata of the provided input",The code unit should validate the implied and derived quantities of the metadata (such as such as the actual size of a file instead of a specified size indexes; offsets; or positions into more complex data structures symbolic keys or other elements into hash tables; associative arrays; etc.),20,implied or derived quantities; such as the actual size of a file instead of a specified size indexes; offsets; or positions into more complex data structures symbolic keys or other elements into hash tables; associative arrays; etc.
M247,"1. The code unit processes XML documents
2. The XML document contains URIs as an XML entity",The code unit should prevent the URIs in XML entities of an XML document that resolve to documents outside of the intended sphere of control,611,The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control; causing the product to embed incorrect documents into its output.
M248,"1. The code unit processes XML documents
",The code unit should configure the XML parsers and validatory to disable externa entity expansion,611,Many XML parsers and validators can be configured to disable external entity expansion.
M249,The code unit writes or copies data,The code unit should writes data past the end or before the beginning of the intended buffer,787,The product writes data past the end; or before the beginning; of the intended buffer.
M250,"1. The code is written in C
2. The code unit writes or copies data",The code unit should uses a vetted library or framework that does not allow outo f bounds writing weakness or provides constructs that avoids this weakness such as safe C string library or Strsafe.h library,787,"Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.

Examples include the Safe C String Library (SafeStr) by Messier and Viega [REF-57]; and the Strsafe.h library from Microsoft [REF-56]. These libraries provide safer versions of overflow-prone string-handling functions."
C1,The code unit handles zip archive files,The output paths constructed from Zip archive entries should be validated,22,"Ensure that output paths constructed from Zip archive entries are validated
to prevent writing files to unexpected locations."
C2,The code unit handles zip archive files,Call extract() or extractall() to write an output file from a Zip archive entry,22,The recommended way of writing an output file from a Zip archive entry is to call extract() or extractall()
C3,The code unit handles tar archive files,The output paths constructed from tar archive entries should be validated,22,"Ensure that output paths constructed from tar archive entries are validated
to prevent writing files to unexpected locations."
C4,The code unit handles tar archive files,""".."" should not occur in the path while writing an output file from a tar archive entry",22,"The recommended way of writing an output file from a tar archive entry is to check that
"".."" does not occur in the path."
C5,The code unit handles files and filepaths,"Validate user input before using it to construct a file path using a library function
like werkzeug.utils.secure_filename; or by custom validation.",22,"Validate user input before using it to construct a file path; either using an off-the-shelf library function
like werkzeug.utils.secure_filename; or by performing custom validation."
C6,The code unit handles files and filepaths,"Do not allow more than a single ""."" character in a user-provided filepath.",22,"Do not allow more than a single ""."" character."
C7,The code unit handles files and filepaths,"Do not allow directory separators such as ""/"" or ""\"" in a user-provided filepath.",22,"Do not allow directory separators such as ""/"" or ""\"" (depending on the file system)."
C8,The code unit handles files and filepaths,Use an allowlist of known good patterns for user-provided filepaths.,22,Use an allowlist of known good patterns.
C9,The code unit handles files and filepaths,Validate user input before using it to construct a file path.,22,Validate user input before using it to construct a file path.
C10,The code unit handles files and filepaths,"The normalized path should be relative and does not contain
any "".."" components; ",22,"Common validation methods include checking that the normalized path is relative and does not contain
any "".."" components; "
C11,The code unit handles files and filepaths,The filepath should be contained within a safe folder,22,"or checking that the path is contained within a safe folder. The method you should use depends 
on how the path is used in the application; and whether the path should be a single path component."
C12,The code unit handles files and filepaths,"Rejects single path components (such as a file name); if any path separators (""/"" or ""\""); or "".."" sequences are found in the input",22,"If the path should be a single path component (such as a file name); you can check for the existence 
of any path separators (""/"" or ""\""); or "".."" sequences in the input; and reject the input if any are found."
C13,The code unit handles user logins or registration,"Remove hard-coded credentials; such as user names; passwords and certificates; from code;
placing them in configuration files or other data stores if necessary.",798,"Remove hard-coded credentials; such as user names; passwords and certificates; from source code;
placing them in configuration files or other data stores if necessary."
C14,The code unit handles user logins or registration,place the credentials in configuration files or other data stores if necessary.,798,"Remove hard-coded credentials; such as user names; passwords and certificates; from source code;
placing them in configuration files or other data stores if necessary."
C15,The code unit handles user logins or registration,"Store configuration files including credential data separately from the source code; in a secure location
with restricted access.",798," If possible; store
configuration files including credential data separately from the source code; in a secure location
with restricted access."
C16,The code unit handles authentications,"For outbound authentication details; encrypt the credentials or the enclosing data
stores or configuration files; and using permissions to restrict access.",798,"For outbound authentication details; consider encrypting the credentials or the enclosing data
stores or configuration files; and using permissions to restrict access."
C17,The code unit handles authentications,"For outbound authentication details; 
use permissions to restrict access to credentials or the enclosing data stores or configuration files",798,"For outbound authentication details; consider encrypting the credentials or the enclosing data
stores or configuration files; and using permissions to restrict access."
C18,The code unit handles authentications,For inbound authentication details;hash passwords using standard library functions like hashlib.pbkdf2_hmac.,798,"For inbound authentication details; consider hashing passwords using standard library functions
where possible. For example; hashlib.pbkdf2_hmac."
C19,The code unit is a python web app,Flask applications should be run with debugging disabled.,200,"Ensure that Flask applications that are run in a production
               environment have debugging disabled."
C20,The code unit is a python web page,Flask applications should be run with debugging disabled.,200,"Ensure that Flask applications that are run in a production
               environment have debugging disabled."
C21,The code unit displays messages ,"Send the user a more generic error message that reveals less information.
",200,"Send the user a more generic error message that reveals less information.
Either suppress the stack trace entirely; or log it only on the server."
C22,The code unit displays messages ,Either suppress the stack trace entirely; or log it only on the server.,200,"Send the user a more generic error message that reveals less information.
Either suppress the stack trace entirely; or log it only on the server."
C23,The code unit handles sensitive data such as login credentials and user information,Sensitive data should not be logged.,200,Sensitive data should not be logged.
C24,The code unit handles sensitive data such as login credentials and user information,"Ensure that sensitive information is always encrypted before being stored.
",200,"Ensure that sensitive information is always encrypted before being stored.
"
C25,"1. The code unit handles sensitive data such as login credentials and user information
2. The code unit handles cookies","If possible; avoid placing sensitive information in cookies altogether.
",200,"If possible; avoid placing sensitive information in cookies altogether.
"
C26,"1. The code unit handles sensitive data such as login credentials or other user information
2. The code unit handles cookies","If sensitive information need to be stored in a cookie; store a key in the cookie that can be used to look up the
sensitive information.",200,"Instead; prefer storing; in the cookie; a key that can be used to look up the
sensitive information."
C27,The code unit handles sensitive data such as login credentials and user info,"In general; decrypt sensitive information only at the point where it is
necessary for it to be used in cleartext.",200,"In general; decrypt sensitive information only at the point where it is
necessary for it to be used in cleartext."
C28,The code unit handles handles hash values,Use hmac.compare_digest() method to securely check the value of Hash.,200,"Two types of countermeasures can be applied against timing attacks. The first one consists 
in eliminating timing variations whereas the second renders these variations useless for an attacker.
The only absolute way to prevent timing attacks is to make the computation strictly constant time;
independent of the input.

 Use hmac.compare_digest() method to securely check the value of Hash.
If this method is used; then the calculation time depends only on the length of input byte arrays;
and does not depend on the contents of the arrays. "
C29,The code unit constructs cookies,Do not use raw user input to construct cookies.,20,Do not use raw user input to construct cookies.
C30,The code unit uses regex,"Escape all meta-characters appropriately when constructing
            regular expressions for security checks;",20,"Escape all meta-characters appropriately when constructing
            regular expressions for security checks;"
C31,The code unit uses regex, Pay special attention to the . meta-character.,20," and pay special attention to the
            . meta-character."
C32,The code unit handles urls,"Parse a URL before performing a check on its host value;
            ",20,"Parse a URL before performing a check on its host value;
            "
C33,The code unit handles urls,Handle arbitrary subdomain sequences in a URL correctly.,20,"and ensure that the check handles arbitrary subdomain sequences
            correctly."
C34,The code unit handles user inputs,Write unambiguous regular expressions to verify user inputs.,20,"Avoid any confusion about which characters are included in the range by 
            writing unambiguous regular expressions.
            Always check that character ranges match only the expected characters."
C35,The code unit handles commands,"Use hard-coded string literals to specify the command to run
or the library to load. ",78,"If possible; use hard-coded string literals to specify the command to run
or the library to load. "
C36,The code unit handles commands,Verify that the user input string is safe before using it in a command.,78,"If the applicable libraries or commands cannot be determined at
compile time; then add code to verify that the user input string is
safe before using it."
C37,The code unit handles commands,Provide the dynamic arguments to the shell as an array to APIs such as subprocess.run.,78,"If possible; provide the dynamic arguments to the shell as an array 
		to APIs such as subprocess.run to avoid interpretation by the shell."
C38,The code unit handles commands,"For dynamically constructed shell commands; ensure that special characters 
do not alter the shell command unexpectedly.",78,"Alternatively; if the shell command must be constructed
		dynamically; then add code to ensure that special characters 
		do not alter the shell command unexpectedly."
C39,The code unit handles commands,Use a library routine to escape characters in the user-supplied string before passing it to a command shell.,78,"Use a library routine to escape characters in the user-supplied
string before passing it to a command shell."
C40,The code unit uses jinja environment,Avoid setting jinja2 autoescape to False.,79,"Avoid setting jinja2 autoescape to False.
Jinja2 provides the function select_autoescape to make sure that the correct auto-escaping is chosen.
For example; it can be used when creating an environment Environment(autoescape=select_autoescape(['html'; 'xml'])"
C41,The code unit constructs messages using user inputs for web pages,"Escape the input before writing user input to the page using functions such as html.escape() or flask.escape
",79,"To guard against cross-site scripting; consider escaping the input before writing user input to the page.
The standard library provides escaping functions: html.escape() for Python 3.2 upwards
or cgi.escape() older versions of Python.
Most frameworks also provide their own escaping functions; for example flask.escape()."
C42,The code unit constructs messages using HTTP parameters for web pages,Escape special characters before writing the HTTP parameter back to the page.,79,"To guard against cross-site scripting; consider escaping special
characters before writing the HTTP parameter back to the page."
C43,The code unit handles database operations,Use query parameters or prepared statements.,89,"Most database connector libraries offer a way of safely
embedding untrusted data into a query by means of query parameters
or prepared statements."
C44,The code unit handles database operations,Use a library routine to escape characters in the user-supplied string before converting it to SQL.,89,"Use a library routine to escape characters in the user-supplied
string before converting it to SQL."
C45,The code unit generates random numbers,Use a secure random generator with Python standard secrets library for Flask.,287," In Flask Consider using a secure random generator with <a href=""https://docs.python.org/3/library/secrets.html#secrets.token_hex"">Python standard secrets library"
C46,The code unit generates random numbers,"Use a secure random generator with ""get_random_secret_key()"""" method from Django",287,"In Django Consider using a secure random generator with ""get_random_secret_key()"""" method from ""django.core.management.utils""."
C47,The code unit handles LDAP connection,Use a non-empty password while establishing an LDAP connection,287,Use a non-empty password while establishing an LDAP connection
C48,The code unit opens files,Ensure that an opened file it is always closed on exiting the method.,400,"Ensure that if you open a file it is always closed on exiting the method.
Wrap the code between the open() and close()
functions in a with statement or use a try...finally
statement. Using a with statement is preferred as it is shorter
and more readable."
C49,The code unit parses data,"Disable entity expansion when parsing untrusted
data.",400,"The safest way to prevent XML bomb attacks is to disable entity expansion when parsing untrusted
data. Whether this can be done depends on the library being used. Note that some libraries; such as
lxml; have measures enabled by default to prevent such DoS XML attacks; so
unless you have explicitly set huge_tree to True; no further action is needed."
C50,The code unit parses XML data,Use the defusedxml PyPI package; to prevent XML attacks.,400,"We recommend using the <a href=""https://pypi.org/project/defusedxml/"">defusedxml</a>
PyPI package; which has been created to prevent XML attacks (both XXE and XML bombs)."
C51,The code unit handles normalization operations,Limit the size of any incoming data that would go through a costly operations; including a Windows Unicode normalization with NFKC or NFKD.,400,Ensure limiting the size of any incoming data that would go through a costly operations; including a Windows Unicode normalization with NFKC or NFKD. Such a recommandation would avoid a potential denial of service.
C52,The code unit parses serializable data,"Avoid deserialization of untrusted data where possible and use other formats instead of serialized objects;
for example JSON.",502,"Avoid deserialization of untrusted data if at all possible.  If the
architecture permits it then use other formats instead of serialized objects;
for example JSON."
C53,The code unit reads YAML data,If you need to use YAML; use the yaml.safe_load function.,502,If you need to use YAML; use the yaml.safe_load function.
C54,The code unit handles LDAP connections,Always set use_SSL to True; call start_tls_s() or set a proper option flag (ldap.OPT_X_TLS_XXXXXX).,522,Always set use_SSL to True; call start_tls_s() or set a proper option flag (ldap.OPT_X_TLS_XXXXXX).
C55,The code unit handles buffer operations,For functions such as memcpy; memset or strncpy; ensure that the size value for the operation is no greater than the amount of space available in the destination buffer.,119,When accessing buffers with functions such as memcpy; memset or strncpy; ensure that the size value for the operation is no greater than the amount of space available in the destination buffer.  Failure to do this may permit a buffer overwrite to occur.  
C56,The code unit handles buffer operations,Also ensure that the size value is no greater than the amount of data in the source buffer,119,Also ensure that the size value is no greater than the amount of data in the source buffer; to prevent a buffer overread from occurring.
C57,The code unit takes user inputs,Validate the user input.,190,Validate the user input.
C58,The code unit performs arithmetic operations,The result of an arithmetic expression should be less than; or equal to; the maximum value for the type; for example INT_MAX.,190,"Define a guard on the arithmetic expression; so that the operation is performed only if the
result can be known to be less than; or equal to; the maximum value for the type; for example INT_MAX."
C59,The code unit performs arithmetic operations,Use a wider type; so that larger input values do not cause overflow.,190,Use a wider type; so that larger input values do not cause overflow.
C60,The code unit performs arithmetic operations,Before using the variable; ensure that it is reassigned a value that does not cause an overflow; or use a wider type to do the arithmetic.,190,"Before using the variable; ensure that it is reassigned a value that does not cause an overflow;
or use a wider type to do the arithmetic."
C61,The code unit performs arithmetic operations,"Change the types of the compared values so that the value on the narrower side of the
comparison is at least as wide as the value it is being compared with.",190,"Change the types of the compared values so that the value on the narrower side of the
comparison is at least as wide as the value it is being compared with."
C62,The code unit performs arithmetic operations,"Implement a guard with the expected range for the parameter and make sure that the input value meets both the minimum and maximum
requirements for this range.",190,"Guard all integer parameters that come from an external
user. Implement a guard with the expected range for the parameter and
make sure that the input value meets both the minimum and maximum
requirements for this range. If the input value fails this guard then
reject the request before proceeding further. If the input value
passes the guard then subsequent calculations should not overflow.<"
C63,The code unit handles temporary containers,Never create an iterator to a temporary container when the iterator is expected to be used after the container's lifetime has expired.,416,Never create an iterator to a temporary container when the iterator is expected to be used after the container's lifetime has expired.
C64,The code unit handles pointers,Ensure that the pointer returned by c_str does not outlive the underlying std::string object.,416,Ensure that the pointer returned by c_str does not outlive the underlying std::string object.
C65,The code unit handles pointers,Ensure that the pointer returned by get does not outlive the underlying std::unique_ptr object.,416,Ensure that the pointer returned by get does not outlive the underlying std::unique_ptr object.
C66,The code unit handles memory,When releasing memory in a catch block; be sure that the memory was allocated and has not already been released.,476,When releasing memory in a catch block; be sure that the memory was allocated and has not already been released.
C67,"1. The code unit processes XML documents
",The code unit should disable external entity handling when parsing untrusted data,611,"The easiest way to prevent XXE attacks is to disable external entity handling when
parsing untrusted data. "
C68,"1. The code unit processes XML documents
",The code unit should use libraries such as defusedxml; libxml; rexml; nokogiri; libxml-ruby depending on the programming language.,611,"We recommend using the <a href=""https://pypi.org/project/defusedxml/"">defusedxml</a>
PyPI package; which has been created to prevent XML attacks (both XXE and XML bombs)."
C69,"1. The code unit processes XML documents
",The code unit should disable external entity handling when parsing untrusted data,611,"The easiest way to prevent XXE attacks is to disable external entity handling when
parsing untrusted data. "
C70,"1. The code unit processes XML documents
",The code unit should disable the parsing of any Document Type Declarations (DTDs) in untrsuted data.,611,"The best way to prevent XXE attacks is to disable the parsing of any Document Type Declarations (DTDs) in untrusted data.
If this is not possible you should disable the parsing of external general entities and external parameter entities.
"