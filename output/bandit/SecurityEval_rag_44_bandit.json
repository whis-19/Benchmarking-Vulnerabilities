{
  "errors": [],
  "generated_at": "2026-02-08T00:59:53Z",
  "metrics": {
    "/tmp/tmpj7yt0cic.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 3,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 196,
      "nosec": 0,
      "skipped_tests": 0
    },
    "_totals": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 3,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 196,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "174 \n175 def first_login_setup(username, password, password_file=\"passwords.txt\"):\n176     \"\"\"\n177     Handles the \"first login\" scenario, requiring a strong password.\n178     Stores the hashed password and salt securely.\n179 \n180     Args:\n181         username (str): The username for the new account.\n182         password (str): The user's chosen password.\n183         password_file (str): The file to store the username, salt, and hash.\n184     \"\"\"\n185 \n186     # Validate password strength (example - customize as needed)\n187     if len(password) < 12:\n188         raise ValueError(\"Password must be at least 12 characters long.\")\n189     if not any(char.isdigit() for char in password):\n190         raise ValueError(\"Password must contain at least one digit.\")\n191     if not any(char.isupper() for char in password):\n192         raise ValueError(\"Password must contain at least one uppercase letter.\")\n193     if not any(char.islower() for char in password):\n194         raise ValueError(\"Password must contain at least one lowercase letter.\")\n195     if not any(not char.isalnum() for char in password):\n196         raise ValueError(\"Password must contain at least one special character.\")\n197 \n198     salt, hashed_password = hash_password(password)\n199 \n200     # Store the username, salt, and hash securely.  Consider using a database instead of a plain text file.\n201     try:\n202         with open(password_file, \"a\") as f:  # Append to the file\n203             f.write(f\"{username}:{salt.hex()}:{hashed_password.hex()}\\n\")\n204         # Restrict access to the password file (UNIX-like systems)\n205         os.chmod(password_file, 0o600)  # Owner read/write only\n206     except Exception as e:\n207         print(f\"Error storing password: {e}\")\n208         raise\n209 \n210     print(f\"User {username} created successfully.  Password stored securely.\")\n211 \n",
      "col_offset": 0,
      "end_col_offset": 78,
      "filename": "/tmp/tmpj7yt0cic.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'passwords.txt'",
      "line_number": 175,
      "line_range": [
        175,
        176,
        177,
        178,
        179,
        180,
        181,
        182,
        183,
        184,
        185,
        186,
        187,
        188,
        189,
        190,
        191,
        192,
        193,
        194,
        195,
        196,
        197,
        198,
        199,
        200,
        201,
        202,
        203,
        204,
        205,
        206,
        207,
        208,
        209,
        210
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b107_hardcoded_password_default.html",
      "test_id": "B107",
      "test_name": "hardcoded_password_default"
    },
    {
      "code": "212 \n213 def verify_credentials_from_file(username, password, password_file=\"passwords.txt\"):\n214     \"\"\"\n215     Verifies user credentials against stored hash in a file.\n216 \n217     Args:\n218         username (str): The username to verify.\n219         password (str): The password to verify.\n220         password_file (str): The file containing the username, salt, and hash.\n221 \n222     Returns:\n223         bool: True if the credentials are valid, False otherwise.\n224     \"\"\"\n225     try:\n226         with open(password_file, \"r\") as f:\n227             for line in f:\n228                 stored_username, salt_hex, hash_hex = line.strip().split(\":\")\n229                 if stored_username == username:\n230                     salt = bytes.fromhex(salt_hex)\n231                     stored_hash = bytes.fromhex(hash_hex)\n232                     return verify_password(password, salt, stored_hash)\n233         return False  # User not found\n234     except FileNotFoundError:\n235         print(\"Password file not found.\")\n236         return False\n237     except Exception as e:\n238         print(f\"Error verifying credentials: {e}\")\n239         return False\n240 \n",
      "col_offset": 0,
      "end_col_offset": 20,
      "filename": "/tmp/tmpj7yt0cic.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'passwords.txt'",
      "line_number": 213,
      "line_range": [
        213,
        214,
        215,
        216,
        217,
        218,
        219,
        220,
        221,
        222,
        223,
        224,
        225,
        226,
        227,
        228,
        229,
        230,
        231,
        232,
        233,
        234,
        235,
        236,
        237,
        238,
        239
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b107_hardcoded_password_default.html",
      "test_id": "B107",
      "test_name": "hardcoded_password_default"
    },
    {
      "code": "253     # Example Usage (Demonstrates password hashing and verification)\n254     new_password = \"MyStrongPassword123!\"\n255     try:\n",
      "col_offset": 19,
      "end_col_offset": 41,
      "filename": "/tmp/tmpj7yt0cic.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'MyStrongPassword123!'",
      "line_number": 254,
      "line_range": [
        254
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    }
  ]
}