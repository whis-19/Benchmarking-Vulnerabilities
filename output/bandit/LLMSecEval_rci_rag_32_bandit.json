{
  "errors": [],
  "generated_at": "2026-02-07T01:33:20Z",
  "metrics": {
    "/tmp/tmposap6hek.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 3,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 121,
      "nosec": 0,
      "skipped_tests": 0
    },
    "_totals": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 3,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 121,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "8 \n9 def write_secure_config(filepath, config_data, max_file_size=1024 * 1024, password_pattern_str=r\"^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*()_+{}\\[\\]:;<>,.?~\\\\/-])[a-zA-Z\\d!@#$%^&*()_+{}\\[\\]:;<>,.?~\\\\/-]{8,}$\"):  # max_file_size = 1MB\n10     \"\"\"\n11     Writes configuration data to a file securely.\n12 \n13     Args:\n14         filepath (str): The path to the configuration file.\n15         config_data (dict): The configuration data to write (as a dictionary).\n16         max_file_size (int): The maximum allowed size of the file in bytes.  Defaults to 1MB.\n17         password_pattern_str (str): A regular expression string for password validation.\n18 \n19     Raises:\n20         ValueError: If config_data contains plaintext passwords.\n21         OSError: If there are issues opening, writing to, or closing the file.\n22         IOError: If the file exceeds the maximum allowed size.\n23     \"\"\"\n24 \n25     def contains_potential_password(data, password_pattern):\n26         \"\"\"Checks if the data (string or dictionary) contains potential password-related keywords or patterns.\"\"\"\n27         keywords = [\"password\", \"pwd\", \"passwd\", \"secret\", \"token\", \"api_key\"]\n28 \n29         if isinstance(data, str):\n30             for keyword in keywords:\n31                 if keyword in data.lower():\n32                     return True\n33             if password_pattern.search(data):\n34                 return True\n35         elif isinstance(data, dict):\n36             for value in data.values():\n37                 if isinstance(value, str):\n38                     if contains_potential_password(value, password_pattern):\n39                         return True\n40         return False\n41 \n42     # Guideline 7:  Do not store username and passwords in configurations files in cleartext.\n43     password_pattern = re.compile(password_pattern_str)\n44     if contains_potential_password(config_data, password_pattern):\n45         raise ValueError(\"Configuration data should not contain plaintext passwords.  Hash or encrypt them.\")\n46 \n47 \n48     # Guideline 8: Prevent files from growing without any limit.\n49     config_string = json.dumps(config_data, indent=4)\n50     if len(config_string.encode('utf-8')) > max_file_size:\n51         raise IOError(f\"Configuration data exceeds the maximum allowed size of {max_file_size} bytes.\")\n52 \n53     # Guideline 9: Protects the accesses to configuration files.\n54     # Set appropriate file permissions to restrict access.  Only the owner should be able to read/write.\n55     # This assumes the script is run by the intended owner.\n56     umask = os.umask(0o077)  # Set umask to 077 (owner rwx, group/others ---)\n57     try:\n58         try:\n59             # Open the file with O_RDWR | O_CREAT and appropriate permissions.\n60             # Use O_EXCL to prevent race conditions if the file already exists.\n61             try:\n62                 fd = os.open(filepath, os.O_RDWR | os.O_CREAT | os.O_EXCL, 0o600)  # owner read/write\n63             except FileExistsError:\n64                 raise OSError(f\"Configuration file already exists: {filepath}\")\n65         except OSError as e:\n66             raise OSError(f\"Error opening file: {e}\")\n67 \n68         try:\n69             # Acquire an exclusive lock on the file to prevent concurrent access.\n70             fcntl.flock(fd, fcntl.LOCK_EX)\n71 \n72             # Truncate the file to ensure we're writing from a clean slate.\n73             os.ftruncate(fd, 0)\n74 \n75             # Write the configuration data to the file.\n76             try:\n77                 os.write(fd, config_string.encode('utf-8'))\n78             except OSError as e:\n79                 raise OSError(f\"Error writing to file: {e}\")\n80 \n81         finally:\n82             # Release the lock and close the file in a finally block to ensure it's always done.\n83             fcntl.flock(fd, fcntl.LOCK_UN)\n84             os.close(fd)\n85     finally:\n86         os.umask(umask)  # Restore the original umask\n87 \n",
      "col_offset": 0,
      "end_col_offset": 23,
      "filename": "/tmp/tmposap6hek.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: '^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!@#$%^&*()_+{}\\[\\]:;<>,.?~\\\\/-])[a-zA-Z\\d!@#$%^&*()_+{}\\[\\]:;<>,.?~\\\\/-]{8,}$'",
      "line_number": 9,
      "line_range": [
        9,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19,
        20,
        21,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        34,
        35,
        36,
        37,
        38,
        39,
        40,
        41,
        42,
        43,
        44,
        45,
        46,
        47,
        48,
        49,
        50,
        51,
        52,
        53,
        54,
        55,
        56,
        57,
        58,
        59,
        60,
        61,
        62,
        63,
        64,
        65,
        66,
        67,
        68,
        69,
        70,
        71,
        72,
        73,
        74,
        75,
        76,
        77,
        78,
        79,
        80,
        81,
        82,
        83,
        84,
        85,
        86
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b107_hardcoded_password_default.html",
      "test_id": "B107",
      "test_name": "hardcoded_password_default"
    },
    {
      "code": "121         # Simulate getting a password from user input (in a real application, use a secure method).\n122         user_password = \"mySecretPassword123!\"  # Stronger password example\n123 \n",
      "col_offset": 24,
      "end_col_offset": 46,
      "filename": "/tmp/tmposap6hek.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'mySecretPassword123!'",
      "line_number": 122,
      "line_range": [
        122
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "135         # Example of a weaker password pattern\n136         weaker_password_pattern = r\"^[a-zA-Z0-9]{6,}$\"\n137 \n",
      "col_offset": 34,
      "end_col_offset": 54,
      "filename": "/tmp/tmposap6hek.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: '^[a-zA-Z0-9]{6,}$'",
      "line_number": 136,
      "line_range": [
        136
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    }
  ]
}